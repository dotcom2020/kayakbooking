<h1><%= @user.first_name %>'s dashboard</h1>

<div>
  <% @user.bookings.each do |booking| %>
    <% if booking.status == "Pending" %>
      <h3>My pending requests</h3>
      <p>You asked <strong><%= booking.kayak.user.first_name %></strong> to rent his kayak</p>
      <p>from <strong><%= booking.start_date.to_date.strftime("%d %B %Y") %></strong> to <strong><%= booking.end_date.to_date.strftime("%d %B %Y") %></strong></p>
      <p>For : <%= booking.total_price %>€</p>
      <p><%= link_to "Cancel my request", booking_path(booking), method: :delete, data: { confirm: "Are you sure" } %></p>
    <% elsif booking.status == "Accepted" %>
      <h3>My accepted requests</h3>
      <p><strong><%= booking.kayak.user.first_name %></strong>'s' kayak</p>
      <p>from <strong><%= booking.start_date.to_date.strftime("%d %B %Y") %></strong> to <strong><%= booking.end_date.to_date.strftime("%d %B %Y") %></strong></p>
      <p>For : <%= booking.total_price %>€</p>
    <% end %>
  <% end %>
</div>

<div>
  <h3>Request for my kayaks</h3>
  <% @user.kayaks.each do |kayak| %>
    <% if kayak.bookings.present? %>
      <% kayak.bookings.each do |booking| %>
        <% if booking.status == "Pending" %>
          <p>Asked by <%= booking.user.first_name %></p>
          <p>from <strong><%= booking.start_date.to_date.strftime("%d %B %Y") %></strong> to <strong><%= booking.end_date.to_date.strftime("%d %B %Y") %></strong></p>
          <p>For : <%= booking.total_price %>€</p>
          <%= link_to "Accept this request",  %>
          <%= link_to "Decline this request",  %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>

<% console %>